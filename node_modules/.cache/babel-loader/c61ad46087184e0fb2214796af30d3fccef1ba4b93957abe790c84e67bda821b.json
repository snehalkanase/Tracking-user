{"ast":null,"code":"import _slicedToArray from\"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import jwt_decode from\"jwt-decode\";import Error from'./pages/error';import Home from'./pages/homes';import React,{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";function App(){var _useState=useState('Initial'),_useState2=_slicedToArray(_useState,2),screen=_useState2[0],setScreen=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var queryParameters=new URLSearchParams(window.location.search);var token=queryParameters.get('token');// const [PermissionStatus, setPermissionStatus] = useState('')\nvar checkPermission=React.useCallback(function(){if('geolocation'in navigator){navigator.permissions.query({name:'geolocation'}).then(function(result){if(result.state===\"granted\"){setScreen('Home');}else if(result.state==='prompt'){setScreen('No-GPS');requestPermission();}else{setScreen('Error');}}).catch(function(error){console.error('Error checking location permission:',error);});}else{setScreen('No-GPS');}},[]);useEffect(function(){try{var decoded=jwt_decode(token);console.log(decoded);setName(decoded.name);var expiryTime=decoded.exp;var currentTime=Math.floor(Date.now()/1000);if(currentTime<expiryTime){checkPermission();}else{setScreen('Expired');}}catch(error){setScreen('Invalid');}},[token,checkPermission]);var requestPermission=function requestPermission(){navigator.geolocation.getCurrentPosition(function(position){console.log(position);// console.log(position.coords.longitude);\nsetScreen('Home');},function(error){console.log(\"This is an error.\");console.log(error);},{enableHighAccuracy:true,timeout:5000});};switch(screen){case'Initial':return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Error,{image:'expired.svg',title:'Please Wait',subTitle:'Loading'})});case'Home':return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Home,{name:name})});case'Expired':return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Error,{image:'expired.svg',title:'Oops, this link is expired!',subTitle:'Please request a new link from an administrator'})});case'Invalid':return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Error,{image:'invalid.svg',title:'Test',subTitle:'Test SubTitle'})});case'No-GPS':return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Error,{image:'no_gps.svg',title:'No GPS!',subTitle:\"Satellite can't find you\"})});default:return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Error,{image:'no_gps.svg',title:'Error',subTitle:\"Something went wrong\"})});}}export default App;","map":{"version":3,"names":["jwt_decode","Error","Home","React","useEffect","useState","jsx","_jsx","App","_useState","_useState2","_slicedToArray","screen","setScreen","_useState3","_useState4","name","setName","queryParameters","URLSearchParams","window","location","search","token","get","checkPermission","useCallback","navigator","permissions","query","then","result","state","requestPermission","catch","error","console","decoded","log","expiryTime","exp","currentTime","Math","floor","Date","now","geolocation","getCurrentPosition","position","enableHighAccuracy","timeout","children","image","title","subTitle"],"sources":["C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/src/App.js"],"sourcesContent":["import jwt_decode from \"jwt-decode\";\nimport Error from './pages/error';\nimport Home from './pages/homes';\nimport React, { useEffect, useState } from 'react';\n\n\n\nfunction App() {\n  const [screen, setScreen] = useState('Initial');\n  const [name, setName] = useState('');\n  const queryParameters = new URLSearchParams(window.location.search);\n  const token = queryParameters.get('token');\n// const [PermissionStatus, setPermissionStatus] = useState('')\nconst checkPermission = React.useCallback(()=>{\n  if('geolocation' in navigator){\n    navigator.permissions.query({name: 'geolocation'}).then(result => {\n       if(result.state === \"granted\"){\n         setScreen('Home');\n       }else if(result.state === 'prompt'){\n        setScreen('No-GPS');\n        requestPermission()\n       } else{\n        setScreen('Error')\n       }\n    }).catch(error => {\n      console.error('Error checking location permission:', error);\n    });\n  }\n  else{\n    setScreen('No-GPS')\n  }\n}, [])\n\n  useEffect(() => {\n    try {\n      const decoded = jwt_decode(token);\n      console.log(decoded);\n      setName(decoded.name);\n      const expiryTime = decoded.exp;\n      const currentTime = Math.floor(Date.now() / 1000);\n      if (currentTime < expiryTime) {\n        checkPermission();\n      } else {\n        setScreen('Expired');\n      }\n    } catch (error) {\n      setScreen('Invalid');\n    }\n  },[token, checkPermission]);\n\n\n  const requestPermission = () => {\n    navigator.geolocation.getCurrentPosition(\n      (position)=>{\n        console.log(position);\n        // console.log(position.coords.longitude);\n        setScreen('Home') \n      },\n      (error)=>{\n        console.log(\"This is an error.\")\n        console.log(error)\n      },\n      { enableHighAccuracy: true, timeout: 5000 }\n    );\n  }\n\n  switch (screen) {\n    case 'Initial':\n      return (\n        <div>\n          <Error image={'expired.svg'} title={'Please Wait'} subTitle={'Loading'} />\n        </div>\n      );\n    case 'Home':\n      return (\n        <div>\n          <Home name={name} />\n\n        </div>\n      );\n    case 'Expired':\n      return (\n        <div>\n          <Error\n            image={'expired.svg'}\n            title={'Oops, this link is expired!'}\n            subTitle={'Please request a new link from an administrator'}\n          />\n        </div>\n      );\n    case 'Invalid':\n      return (\n        <div>\n          <Error image={'invalid.svg'} title={'Test'} subTitle={'Test SubTitle'} />\n        </div>\n      );\n    case 'No-GPS':\n      return (\n        <div>\n          <Error image={'no_gps.svg'} title={'No GPS!'} subTitle={\"Satellite can't find you\"} />\n        </div>\n      );\n    default:\n      return (\n        <div>\n          <Error image={'no_gps.svg'} title={'Error'} subTitle={\"Something went wrong\"} />\n        </div>\n      );\n  }\n}\nexport default App;\n"],"mappings":"oJAAA,MAAO,CAAAA,UAAU,KAAM,YAAY,CACnC,MAAO,CAAAC,KAAK,KAAM,eAAe,CACjC,MAAO,CAAAC,IAAI,KAAM,eAAe,CAChC,MAAO,CAAAC,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAInD,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,IAAAC,SAAA,CAA4BJ,QAAQ,CAAC,SAAS,CAAC,CAAAK,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAxCG,MAAM,CAAAF,UAAA,IAAEG,SAAS,CAAAH,UAAA,IACxB,IAAAI,UAAA,CAAwBT,QAAQ,CAAC,EAAE,CAAC,CAAAU,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA7BE,IAAI,CAAAD,UAAA,IAAEE,OAAO,CAAAF,UAAA,IACpB,GAAM,CAAAG,eAAe,CAAG,GAAI,CAAAC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CACnE,GAAM,CAAAC,KAAK,CAAGL,eAAe,CAACM,GAAG,CAAC,OAAO,CAAC,CAC5C;AACA,GAAM,CAAAC,eAAe,CAAGtB,KAAK,CAACuB,WAAW,CAAC,UAAI,CAC5C,GAAG,aAAa,EAAI,CAAAC,SAAS,CAAC,CAC5BA,SAAS,CAACC,WAAW,CAACC,KAAK,CAAC,CAACb,IAAI,CAAE,aAAa,CAAC,CAAC,CAACc,IAAI,CAAC,SAAAC,MAAM,CAAI,CAC/D,GAAGA,MAAM,CAACC,KAAK,GAAK,SAAS,CAAC,CAC5BnB,SAAS,CAAC,MAAM,CAAC,CACnB,CAAC,IAAK,IAAGkB,MAAM,CAACC,KAAK,GAAK,QAAQ,CAAC,CAClCnB,SAAS,CAAC,QAAQ,CAAC,CACnBoB,iBAAiB,CAAC,CAAC,CACpB,CAAC,IAAK,CACLpB,SAAS,CAAC,OAAO,CAAC,CACnB,CACH,CAAC,CAAC,CAACqB,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChBC,OAAO,CAACD,KAAK,CAAC,qCAAqC,CAAEA,KAAK,CAAC,CAC7D,CAAC,CAAC,CACJ,CAAC,IACG,CACFtB,SAAS,CAAC,QAAQ,CAAC,CACrB,CACF,CAAC,CAAE,EAAE,CAAC,CAEJT,SAAS,CAAC,UAAM,CACd,GAAI,CACF,GAAM,CAAAiC,OAAO,CAAGrC,UAAU,CAACuB,KAAK,CAAC,CACjCa,OAAO,CAACE,GAAG,CAACD,OAAO,CAAC,CACpBpB,OAAO,CAACoB,OAAO,CAACrB,IAAI,CAAC,CACrB,GAAM,CAAAuB,UAAU,CAAGF,OAAO,CAACG,GAAG,CAC9B,GAAM,CAAAC,WAAW,CAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,IAAI,CAAC,CACjD,GAAIJ,WAAW,CAAGF,UAAU,CAAE,CAC5Bd,eAAe,CAAC,CAAC,CACnB,CAAC,IAAM,CACLZ,SAAS,CAAC,SAAS,CAAC,CACtB,CACF,CAAE,MAAOsB,KAAK,CAAE,CACdtB,SAAS,CAAC,SAAS,CAAC,CACtB,CACF,CAAC,CAAC,CAACU,KAAK,CAAEE,eAAe,CAAC,CAAC,CAG3B,GAAM,CAAAQ,iBAAiB,CAAG,QAApB,CAAAA,iBAAiBA,CAAA,CAAS,CAC9BN,SAAS,CAACmB,WAAW,CAACC,kBAAkB,CACtC,SAACC,QAAQ,CAAG,CACVZ,OAAO,CAACE,GAAG,CAACU,QAAQ,CAAC,CACrB;AACAnC,SAAS,CAAC,MAAM,CAAC,CACnB,CAAC,CACD,SAACsB,KAAK,CAAG,CACPC,OAAO,CAACE,GAAG,CAAC,mBAAmB,CAAC,CAChCF,OAAO,CAACE,GAAG,CAACH,KAAK,CAAC,CACpB,CAAC,CACD,CAAEc,kBAAkB,CAAE,IAAI,CAAEC,OAAO,CAAE,IAAK,CAC5C,CAAC,CACH,CAAC,CAED,OAAQtC,MAAM,EACZ,IAAK,SAAS,CACZ,mBACEL,IAAA,QAAA4C,QAAA,cACE5C,IAAA,CAACN,KAAK,EAACmD,KAAK,CAAE,aAAc,CAACC,KAAK,CAAE,aAAc,CAACC,QAAQ,CAAE,SAAU,CAAE,CAAC,CACvE,CAAC,CAEV,IAAK,MAAM,CACT,mBACE/C,IAAA,QAAA4C,QAAA,cACE5C,IAAA,CAACL,IAAI,EAACc,IAAI,CAAEA,IAAK,CAAE,CAAC,CAEjB,CAAC,CAEV,IAAK,SAAS,CACZ,mBACET,IAAA,QAAA4C,QAAA,cACE5C,IAAA,CAACN,KAAK,EACJmD,KAAK,CAAE,aAAc,CACrBC,KAAK,CAAE,6BAA8B,CACrCC,QAAQ,CAAE,iDAAkD,CAC7D,CAAC,CACC,CAAC,CAEV,IAAK,SAAS,CACZ,mBACE/C,IAAA,QAAA4C,QAAA,cACE5C,IAAA,CAACN,KAAK,EAACmD,KAAK,CAAE,aAAc,CAACC,KAAK,CAAE,MAAO,CAACC,QAAQ,CAAE,eAAgB,CAAE,CAAC,CACtE,CAAC,CAEV,IAAK,QAAQ,CACX,mBACE/C,IAAA,QAAA4C,QAAA,cACE5C,IAAA,CAACN,KAAK,EAACmD,KAAK,CAAE,YAAa,CAACC,KAAK,CAAE,SAAU,CAACC,QAAQ,CAAE,0BAA2B,CAAE,CAAC,CACnF,CAAC,CAEV,QACE,mBACE/C,IAAA,QAAA4C,QAAA,cACE5C,IAAA,CAACN,KAAK,EAACmD,KAAK,CAAE,YAAa,CAACC,KAAK,CAAE,OAAQ,CAACC,QAAQ,CAAE,sBAAuB,CAAE,CAAC,CAC7E,CAAC,CAEZ,CACF,CACA,cAAe,CAAA9C,GAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}