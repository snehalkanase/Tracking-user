{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/Genxhire/Projects/Website/esurveillance-local-tracker/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { BaseRequestPolicy, isNode } from \"@azure/core-http\";\nimport { HeaderConstants, URLConstants } from \"../utils/constants\";\nimport { setURLParameter } from \"../utils/utils.common\";\n/**\n * StorageBrowserPolicy will handle differences between Node.js and browser runtime, including:\n *\n * 1. Browsers cache GET/HEAD requests by adding conditional headers such as 'IF_MODIFIED_SINCE'.\n * StorageBrowserPolicy is a policy used to add a timestamp query to GET/HEAD request URL\n * thus avoid the browser cache.\n *\n * 2. Remove cookie header for security\n *\n * 3. Remove content-length header to avoid browsers warning\n */\nexport var StorageBrowserPolicy = /*#__PURE__*/function (_BaseRequestPolicy) {\n  _inherits(StorageBrowserPolicy, _BaseRequestPolicy);\n  var _super = _createSuper(StorageBrowserPolicy);\n  /**\n   * Creates an instance of StorageBrowserPolicy.\n   * @param nextPolicy -\n   * @param options -\n   */\n  // The base class has a protected constructor. Adding a public one to enable constructing of this class.\n  /* eslint-disable-next-line @typescript-eslint/no-useless-constructor*/\n  function StorageBrowserPolicy(nextPolicy, options) {\n    _classCallCheck(this, StorageBrowserPolicy);\n    return _super.call(this, nextPolicy, options);\n  }\n  /**\n   * Sends out request.\n   *\n   * @param request -\n   */\n  _createClass(StorageBrowserPolicy, [{\n    key: \"sendRequest\",\n    value: function () {\n      var _sendRequest = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(request) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!isNode) {\n                _context.next = 2;\n                break;\n              }\n              return _context.abrupt(\"return\", this._nextPolicy.sendRequest(request));\n            case 2:\n              if (request.method.toUpperCase() === \"GET\" || request.method.toUpperCase() === \"HEAD\") {\n                request.url = setURLParameter(request.url, URLConstants.Parameters.FORCE_BROWSER_NO_CACHE, new Date().getTime().toString());\n              }\n              request.headers.remove(HeaderConstants.COOKIE);\n              // According to XHR standards, content-length should be fully controlled by browsers\n              request.headers.remove(HeaderConstants.CONTENT_LENGTH);\n              return _context.abrupt(\"return\", this._nextPolicy.sendRequest(request));\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function sendRequest(_x) {\n        return _sendRequest.apply(this, arguments);\n      }\n      return sendRequest;\n    }()\n  }]);\n  return StorageBrowserPolicy;\n}(BaseRequestPolicy);","map":{"version":3,"names":["BaseRequestPolicy","isNode","HeaderConstants","URLConstants","setURLParameter","StorageBrowserPolicy","_BaseRequestPolicy","_inherits","_super","_createSuper","nextPolicy","options","_classCallCheck","call","_createClass","key","value","_sendRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","request","wrap","_callee$","_context","prev","next","abrupt","_nextPolicy","sendRequest","method","toUpperCase","url","Parameters","FORCE_BROWSER_NO_CACHE","Date","getTime","toString","headers","remove","COOKIE","CONTENT_LENGTH","stop","_x","apply","arguments"],"sources":["C:\\Users\\Genxhire\\Projects\\Website\\esurveillance-local-tracker\\node_modules\\@azure\\storage-blob\\src\\policies\\StorageBrowserPolicy.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport {\n  BaseRequestPolicy,\n  HttpOperationResponse,\n  isNode,\n  RequestPolicy,\n  RequestPolicyOptions,\n  WebResource,\n} from \"@azure/core-http\";\n\nimport { HeaderConstants, URLConstants } from \"../utils/constants\";\nimport { setURLParameter } from \"../utils/utils.common\";\n\n/**\n * StorageBrowserPolicy will handle differences between Node.js and browser runtime, including:\n *\n * 1. Browsers cache GET/HEAD requests by adding conditional headers such as 'IF_MODIFIED_SINCE'.\n * StorageBrowserPolicy is a policy used to add a timestamp query to GET/HEAD request URL\n * thus avoid the browser cache.\n *\n * 2. Remove cookie header for security\n *\n * 3. Remove content-length header to avoid browsers warning\n */\nexport class StorageBrowserPolicy extends BaseRequestPolicy {\n  /**\n   * Creates an instance of StorageBrowserPolicy.\n   * @param nextPolicy -\n   * @param options -\n   */\n  // The base class has a protected constructor. Adding a public one to enable constructing of this class.\n  /* eslint-disable-next-line @typescript-eslint/no-useless-constructor*/\n  constructor(nextPolicy: RequestPolicy, options: RequestPolicyOptions) {\n    super(nextPolicy, options);\n  }\n\n  /**\n   * Sends out request.\n   *\n   * @param request -\n   */\n  public async sendRequest(request: WebResource): Promise<HttpOperationResponse> {\n    if (isNode) {\n      return this._nextPolicy.sendRequest(request);\n    }\n\n    if (request.method.toUpperCase() === \"GET\" || request.method.toUpperCase() === \"HEAD\") {\n      request.url = setURLParameter(\n        request.url,\n        URLConstants.Parameters.FORCE_BROWSER_NO_CACHE,\n        new Date().getTime().toString()\n      );\n    }\n\n    request.headers.remove(HeaderConstants.COOKIE);\n\n    // According to XHR standards, content-length should be fully controlled by browsers\n    request.headers.remove(HeaderConstants.CONTENT_LENGTH);\n\n    return this._nextPolicy.sendRequest(request);\n  }\n}\n"],"mappings":";;;;;;AAAA;AACA;AAEA,SACEA,iBAAiB,EAEjBC,MAAM,QAID,kBAAkB;AAEzB,SAASC,eAAe,EAAEC,YAAY,QAAQ,oBAAoB;AAClE,SAASC,eAAe,QAAQ,uBAAuB;AAEvD;;;;;;;;;;;AAWA,WAAaC,oBAAqB,0BAAAC,kBAAA;EAAAC,SAAA,CAAAF,oBAAA,EAAAC,kBAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,oBAAA;EAChC;;;;;EAKA;EACA;EACA,SAAAA,qBAAYK,UAAyB,EAAEC,OAA6B;IAAAC,eAAA,OAAAP,oBAAA;IAAA,OAAAG,MAAA,CAAAK,IAAA,OAC5DH,UAAU,EAAEC,OAAO;EAC3B;EAEA;;;;;EAAAG,YAAA,CAAAT,oBAAA;IAAAU,GAAA;IAAAC,KAAA;MAAA,IAAAC,YAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAKO,SAAAC,QAAkBC,OAAoB;QAAA,OAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAA,KACvC1B,MAAM;gBAAAwB,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAA,OAAAF,QAAA,CAAAG,MAAA,WACD,IAAI,CAACC,WAAW,CAACC,WAAW,CAACR,OAAO,CAAC;YAAA;cAG9C,IAAIA,OAAO,CAACS,MAAM,CAACC,WAAW,EAAE,KAAK,KAAK,IAAIV,OAAO,CAACS,MAAM,CAACC,WAAW,EAAE,KAAK,MAAM,EAAE;gBACrFV,OAAO,CAACW,GAAG,GAAG7B,eAAe,CAC3BkB,OAAO,CAACW,GAAG,EACX9B,YAAY,CAAC+B,UAAU,CAACC,sBAAsB,EAC9C,IAAIC,IAAI,EAAE,CAACC,OAAO,EAAE,CAACC,QAAQ,EAAE,CAChC;;cAGHhB,OAAO,CAACiB,OAAO,CAACC,MAAM,CAACtC,eAAe,CAACuC,MAAM,CAAC;cAE9C;cACAnB,OAAO,CAACiB,OAAO,CAACC,MAAM,CAACtC,eAAe,CAACwC,cAAc,CAAC;cAAC,OAAAjB,QAAA,CAAAG,MAAA,WAEhD,IAAI,CAACC,WAAW,CAACC,WAAW,CAACR,OAAO,CAAC;YAAA;YAAA;cAAA,OAAAG,QAAA,CAAAkB,IAAA;UAAA;QAAA,GAAAtB,OAAA;MAAA,CAC7C;MAAA,SAAAS,YAAAc,EAAA;QAAA,OAAA3B,YAAA,CAAA4B,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAhB,WAAA;IAAA;EAAA;EAAA,OAAAzB,oBAAA;AAAA,EApCuCL,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}